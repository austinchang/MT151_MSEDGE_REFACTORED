# MT151_MSEDGE 使用手冊

## 📋 目錄
1. [快速開始](#快速開始)
2. [系統需求](#系統需求)
3. [安裝指南](#安裝指南)
4. [功能介紹](#功能介紹)
5. [操作流程](#操作流程)
6. [進階功能](#進階功能)
7. [故障排除](#故障排除)
8. [常見問題](#常見問題)

## 🚀 快速開始

### 基本操作流程
```bash
# 1. 進入專案目錄
cd MT151_MSEDGE_REFACTORED

# 2. 安裝依賴
pip install -r requirements.txt

# 3. 安裝瀏覽器驅動
playwright install

# 4. 運行主程式
python src/main.py
```

### 第一次使用
1. 啟動程式後選擇選單項目 `1` 啟動瀏覽器
2. 選擇要使用的瀏覽器（建議選擇 Microsoft Edge）
3. 等待自動導航到MMT010系統
4. 手動完成登入（如果需要）
5. 開始使用自動化功能

## 💻 系統需求

### 硬體需求
- **CPU**: 雙核心 2.0GHz 以上
- **記憶體**: 4GB RAM 以上（建議 8GB）
- **硬碟空間**: 2GB 可用空間
- **網路**: 穩定的網際網路連線

### 軟體需求
- **作業系統**: Windows 10/11, macOS 10.14+, Ubuntu 18.04+
- **Python**: 3.8 或更高版本
- **瀏覽器**: Microsoft Edge, Google Chrome, Firefox 其中之一

### 相依套件
- playwright >= 1.40.0
- pydantic >= 2.0.0
- asyncio (Python 內建)
- requests >= 2.31.0

## 📦 安裝指南

### 1. 環境準備
```bash
# 檢查Python版本
python --version

# 建立虛擬環境（建議）
python -m venv venv

# 啟動虛擬環境
# Windows:
venv\Scripts\activate
# macOS/Linux:
source venv/bin/activate
```

### 2. 安裝相依套件
```bash
# 安裝Python套件
pip install -r requirements.txt

# 安裝Playwright瀏覽器
playwright install
```

### 3. 配置設定
```bash
# 複製配置檔案範例
cp config/app_config.json config/app_config_local.json

# 編輯配置檔案（可選）
notepad config/app_config_local.json  # Windows
nano config/app_config_local.json     # Linux/macOS
```

### 4. 測試安裝
```bash
# 運行主程式測試
python src/main.py
```

## 🎯 功能介紹

### 核心功能模組

#### 1. 🌐 瀏覽器管理
- **多瀏覽器支援**: Edge、Chrome、Firefox、Safari
- **自動啟動**: 智能選擇可用瀏覽器
- **持久化模式**: 保留瀏覽器設定和快取
- **截圖功能**: 自動截圖用於除錯

#### 2. 📊 資料管理
- **資料模型**: 使用Pydantic進行資料驗證
- **CRUD操作**: 新增、查詢、編輯、刪除測試資料
- **批量處理**: 支援批量匯入和處理
- **資料驗證**: 智能驗證資料格式和內容
- **匯入匯出**: JSON格式資料交換

#### 3. 🤖 AI智能助手
- **多模型支援**: XAI、Gemini、OpenAI
- **資料分析**: 智能分析測試資料品質
- **錯誤診斷**: 自動診斷並提供解決建議
- **聊天助手**: 自然語言互動
- **操作建議**: 根據當前狀態提供下一步建議

#### 4. 🧪 MMT010自動化
- **表格操作**: DevExpress表格完整支援
- **資料編輯**: 直接在網頁表格中編輯資料
- **批量操作**: 支援批量新增和修改
- **智能等待**: 自動等待頁面載入完成
- **錯誤重試**: 智能重試失敗的操作

### 介面功能

#### 主選單選項
```
1. 🌐 啟動瀏覽器並連線到MMT010
2. 📊 資料管理 (新增、編輯、查看測試資料)
3. 🤖 AI助手 (智能分析、聊天諮詢)
4. 🔍 執行搜尋查詢
5. 💾 執行儲存操作
6. 🧪 測試資料表格操作
7. 🚀 完整自動化流程
8. 🔧 系統設定和配置
9. 📋 查看系統狀態
H. 📖 說明和幫助
Q. 🚪 退出程式
```

## 📝 操作流程

### 基本操作流程

#### 1. 啟動和連線
```
開始 → 選擇選單1 → 選擇瀏覽器 → 等待啟動 → 登入MMT010
```

#### 2. 資料準備
```
選擇選單2 → 選擇資料操作 → 輸入/載入資料 → 驗證資料
```

#### 3. 執行操作
```
選擇選單6 → 選擇表格操作 → 執行自動化 → 查看結果
```

#### 4. 儲存和結束
```
選擇選單5 → 儲存變更 → 選擇選單Q → 安全退出
```

### 詳細操作步驟

#### 第一步：瀏覽器連線
1. 執行 `python src/main.py`
2. 選擇選單項目 `1`
3. 根據提示選擇瀏覽器（建議選擇 `1` Microsoft Edge）
4. 等待瀏覽器啟動並自動導航到MMT010
5. 如果出現登入頁面，手動完成登入
6. 看到 "成功連線到MMT010系統！" 訊息

#### 第二步：資料管理
1. 選擇選單項目 `2`
2. 根據需要選擇資料操作：
   - `1`: 新增單筆測試資料
   - `2`: 編輯現有測試資料
   - `4`: 批量新增測試資料
   - `5`: 查看現有測試資料
   - `6`: 匯出測試資料
   - `7`: 匯入測試資料

#### 第三步：表格操作
1. 選擇選單項目 `6`
2. 選擇要執行的表格操作：
   - `1`: 新增測試資料到MMT010表格
   - `2`: 編輯MMT010表格中的資料
   - `3`: 刪除MMT010表格中的資料
   - `4`: 批量新增資料到表格
   - `5`: 查看表格現有資料

#### 第四步：完整流程
1. 選擇選單項目 `7` 執行完整自動化流程
2. 系統會自動：
   - 確認瀏覽器連線
   - 準備測試資料
   - 執行搜尋查詢
   - 執行資料操作
   - 儲存變更

### 資料格式說明

#### 測試資料欄位
```json
{
  "料號": "C08GL0DIG017A",          // 產品料號，必填
  "站位": "B/I",                   // 測試站位：B/I、FT、PT、SHIP
  "版本": "V3.3.5.9_1.16.0.1E3.12-1", // 軟體版本號
  "描述": "EN0DIGOA1-0322-GL_HL-325L B/I", // 產品描述
  "MFGID群組": "DEFAULT"           // 製造群組，可選
}
```

#### 資料驗證規則
- **料號**: 10位以上大寫字母和數字組合
- **站位**: 必須為 B/I、FT、PT、SHIP 其中之一
- **版本**: 符合特定版本號格式
- **描述**: 至少5個字符
- **MFGID群組**: 可選，預設為 DEFAULT

## 🎮 進階功能

### AI助手功能

#### 1. 智能資料分析
```python
# 在選單3中選擇選項2
AI會分析當前資料集的：
- 資料完整性
- 格式正確性
- 潛在問題
- 改善建議
```

#### 2. 錯誤診斷
```python
# 在選單3中選擇選項3
輸入錯誤訊息，AI會提供：
- 錯誤原因分析
- 解決步驟
- 預防措施
```

#### 3. 互動聊天
```python
# 在選單3中選擇選項1
可以詢問：
- 操作問題
- 功能說明
- 最佳實踐
- 故障排除
```

### 配置檔案自訂

#### 修改瀏覽器設定
```json
{
  "browser": {
    "default_browser": "chrome",  // 修改預設瀏覽器
    "headless": false,           // 是否無頭模式
    "slow_mo": 1000             // 操作延遲（毫秒）
  }
}
```

#### 修改網站設定
```json
{
  "web": {
    "base_url": "https://your-mmt010-url.com",
    "login_timeout": 180000,    // 登入超時時間
    "element_timeout": 15000    // 元素等待超時
  }
}
```

#### 修改AI設定
```json
{
  "ai": {
    "default_model": "gpt-4",   // AI模型選擇
    "temperature": 0.5,         // 回應創意度
    "zen_server_enabled": true  // 是否啟用AI功能
  }
}
```

### 批量操作技巧

#### 批量匯入資料
1. 準備JSON格式的資料檔案
2. 選擇選單 `2` → `7` 匯入測試資料
3. 指定檔案路徑
4. 系統自動驗證和載入

#### 批量處理流程
1. 選擇選單 `2` → `4` 批量新增
2. 輸入要新增的筆數
3. 依序輸入每筆資料
4. 選擇選單 `6` → `4` 批量新增到表格

### 除錯和診斷

#### 頁面結構分析
```python
# 選擇選單6 → 選項6
系統會分析：
- 頁面標題和URL
- 表格元素數量
- 按鈕可用性
- 選擇器狀態
```

#### 截圖功能
```python
# 自動截圖會儲存在 logs/ 目錄
# 手動截圖可以在發生錯誤時使用
```

#### 日誌查看
```bash
# 查看詳細日誌
tail -f logs/mt151_msedge.log

# 搜尋特定錯誤
grep "ERROR" logs/mt151_msedge.log
```

## 🔧 故障排除

### 常見問題解決

#### 1. 瀏覽器啟動失敗
**問題**: 顯示 "所有瀏覽器都無法啟動"

**解決方案**:
```bash
# 重新安裝Playwright瀏覽器
playwright install

# 檢查瀏覽器是否已安裝
playwright install --help

# 手動指定瀏覽器路徑（高級）
export PLAYWRIGHT_BROWSERS_PATH=/path/to/browsers
```

#### 2. MMT010連線失敗
**問題**: 無法連線到MMT010系統

**解決方案**:
1. 檢查網路連線
2. 確認MMT010系統網址正確
3. 檢查VPN或防火牆設定
4. 修改配置檔案中的 `base_url`

#### 3. 元素定位失敗
**問題**: 找不到網頁元素

**解決方案**:
1. 使用除錯模式檢查頁面結構
2. 檢查MMT010系統是否有更新
3. 更新選擇器配置
4. 增加等待時間

#### 4. AI功能無法使用
**問題**: AI助手回應錯誤或無回應

**解決方案**:
1. 檢查zen-mcp-server是否正常運行
2. 確認API金鑰配置正確
3. 檢查網路連線
4. 暫時停用AI功能繼續使用

#### 5. 資料驗證失敗
**問題**: 輸入的資料無法通過驗證

**解決方案**:
1. 檢查資料格式是否符合規則
2. 查看詳細錯誤訊息
3. 使用AI助手分析資料問題
4. 參考範例資料格式

### 效能優化

#### 1. 提升操作速度
```json
{
  "browser": {
    "slow_mo": 100,          // 減少延遲
    "timeout": 15000         // 適當調整超時
  }
}
```

#### 2. 減少記憶體使用
```json
{
  "browser": {
    "headless": true,        // 使用無頭模式
    "chrome_args": [
      "--no-sandbox",
      "--disable-dev-shm-usage"
    ]
  }
}
```

#### 3. 批量操作最佳化
- 使用批量新增而非逐筆新增
- 適當設定批量大小（建議10-20筆）
- 在網路較慢時增加延遲時間

### 日誌和監控

#### 查看運行日誌
```bash
# 即時查看日誌
tail -f logs/mt151_msedge.log

# 查看錯誤日誌
grep "ERROR\|CRITICAL" logs/mt151_msedge.log

# 查看最近100行日誌
tail -n 100 logs/mt151_msedge.log
```

#### 設定日誌級別
```json
{
  "logging": {
    "log_level": "DEBUG",    // 更詳細的日誌
    "console_output": true   // 控制台輸出
  }
}
```

## ❓ 常見問題

### 功能相關

**Q: 如何修改預設的測試資料？**
A: 編輯 `config/test_data.json` 檔案，或在程式中選擇選單2進行資料管理。

**Q: 可以同時操作多個瀏覽器分頁嗎？**
A: 目前版本一次只支援一個瀏覽器分頁，如需多分頁操作請聯繫開發團隊。

**Q: AI功能需要什麼條件？**
A: 需要正確安裝和配置zen-mcp-server，並且網路連線正常。

**Q: 資料會自動備份嗎？**
A: 是的，每次儲存時會自動建立備份檔案在 `config/backup/` 目錄。

### 技術相關

**Q: 支援哪些作業系統？**
A: 支援 Windows 10/11、macOS 10.14+、Ubuntu 18.04+ 及其他主流Linux發行版。

**Q: 最低系統需求是什麼？**
A: Python 3.8+、4GB RAM、2GB硬碟空間、穩定網路連線。

**Q: 如何更新到新版本？**
A: 使用 `git pull` 更新程式碼，然後執行 `pip install -r requirements.txt` 更新依賴。

**Q: 可以在伺服器上無人值守運行嗎？**
A: 可以，設定 `headless: true` 並配置適當的自動化腳本。

### 故障排除

**Q: 程式突然當機怎麼辦？**
A: 查看 `logs/mt151_msedge.log` 找出錯誤原因，重新啟動程式通常可以解決。

**Q: 網頁元素找不到怎麼辦？**
A: 使用除錯模式分析頁面結構，可能需要更新選擇器配置。

**Q: 資料匯入失敗怎麼辦？**
A: 檢查JSON格式是否正確，確認所有必填欄位都有填寫。

**Q: 如何重置所有設定？**
A: 刪除 `config/app_config.json`，程式會自動建立預設配置檔案。

## 📞 技術支援

### 聯繫方式
- **專案倉庫**: GitHub - austinchang/MT151_MSEDGE
- **問題回報**: 請在GitHub Issues中提交
- **功能建議**: 歡迎提交Pull Request

### 自助資源
- **程式碼文件**: 查看各模組的詳細說明
- **範例檔案**: `config/` 目錄中的範例配置
- **日誌檔案**: `logs/` 目錄中的詳細執行記錄

### 開發團隊
本專案由Austin Chang團隊開發維護，並整合Claude AI協助開發。

---

*本使用手冊會隨著軟體版本更新而持續更新，請定期查看最新版本。*